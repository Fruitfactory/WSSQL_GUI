<?xml version="1.0" encoding="utf-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi" xmlns:util="http://schemas.microsoft.com/wix/UtilExtension">
  <Product Id="*" Name="OutlookFinder" Language="1033" Version="1.0.2.7" Manufacturer="FruitFactory" UpgradeCode="6169fa5d-89fa-44d3-9801-cefe8fc8755e" Codepage="1252">
    <Package InstallerVersion="200" Compressed="yes" Description="OutlookFinder" Manufacturer="FruitFactory" Languages="1033" SummaryCodepage="1252" InstallScope="perUser" InstallPrivileges="limited" />
    <!--<MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />-->
    <Upgrade Id="6169fa5d-89fa-44d3-9801-cefe8fc8755e">
      <UpgradeVersion Minimum="0.0.0.0" IncludeMinimum="yes" OnlyDetect="no" Maximum="10.0.0.0" IncludeMaximum="yes" Property="PREVIOUSFOUND" />
    </Upgrade>
    <Media Id="1" Cabinet="OutlookFinder.cab" EmbedCab="yes" />
    <Condition Message="!(Setting the ALLUSERS property is not allowed.)">
      NOT ALLUSERS
    </Condition>
    <Icon Id="MainIcon.exe" SourceFile="Image\logo_64.ico" />
    <Property Id="ARPPRODUCTICON" Value="MainIcon.exe" />
    <Property Id="WIXUI_INSTALLDIR" Value="INSTALLFOLDER" />
    <Property Id="PromptToCloseProcesses" Value="OUTLOOK" />
    <Property Id="PromptToCloseDisplayNames" Value="Outlook" />
    <Property Id="EMAILVALID" Value="true" />
    <WixVariable Id="WixUIBannerBmp" Value="Image\top.bmp" />
    <WixVariable Id="WixUIDialogBmp" Value="Image\dialog.bmp" />
    <UIRef Id="WixUI_FeatureTree" />
    <Property Id="ALLUSERS" Secure="yes" />
    <Feature Id="ProductFeature" Title="OutlookFinder" Level="1" ConfigurableDirectory="INSTALLFOLDER">
      <ComponentRef Id="INSTALLFOLDER" />
      <ComponentRef Id="INSTALLFOLDERLIB" />
      <ComponentRef Id="INSTALLFOLDERLIB64" />
      <ComponentGroupRef Id="ProductComponents" />
    </Feature>

    <Feature Id="ElasticSearchProductFeature" 
             Title="Elastic Search" 
             Level="1"
             Absent="disallow"
             TypicalDefault="install"
             AllowAdvertise="no"
             ConfigurableDirectory="ELASTICSEASRCHINSTALLFOLDER"
             InstallDefault="local"
             >

      
      <ComponentRef Id="ELASTICSEASRCHINSTALLFOLDER" />
      <ComponentRef Id="ELASTICSEASRCHINSTALLFOLDERBIN" />
      <ComponentRef Id="ELASTICSEASRCHINSTALLFOLDERCONFIG" />
      <ComponentRef Id="ELASTICSEASRCHINSTALLFOLDERLIB" />
      <ComponentRef Id="ELASTICSEASRCHINSTALLFOLDERLIBSIGAR" />
      <ComponentRef Id="ELASTICSEASRCHINSTALLFOLDERPLUGINS" />
      <ComponentGroupRef Id="ElasticSearchComponents" />
    </Feature>
    
    
    <?ifndef TRIAL ?>
    <Binary Id="Turbo_Activate_dat" SourceFile="$(var.OF.OutlookPlugin.TargetDir)TurboActivate.dat" />
    <Binary Id="Turbo_Activate_dll" SourceFile="$(var.OF.OutlookPlugin.TargetDir)TurboActivate.dll" />
    <Binary Id="Turbo_Activate_exe" SourceFile="$(var.OF.OutlookPlugin.TargetDir)TurboActivate.exe" />
    <Binary Id="Turbo_Activate64_dll" SourceFile="$(var.OF.OutlookPlugin.TargetDir)TurboActivate64.dll" />
    <Binary Id="pstriver_1_0_SNAPSHOT_zip" SourceFile="$(var.SolutionDir)PSTRiverPlugin\target\releases\pstriver-1.0-SNAPSHOT.zip" />
    <?endif?>
    <Binary Id="adxregistrator_exe" SourceFile="$(var.ADX_PATH)\Redistributables\adxregistrator.exe" />
    <Binary Id="managedAction" SourceFile="$(var.OF.OutlookPlugin.TargetDir)OF.CA.dll" />
    <!--<CustomAction Id="ActivatePlugin" BinaryKey="Turbo_Activate_exe" Execute="deferred" ExeCommand="" Return="ignore" />-->
    <CustomAction Id="RegisterDll" BinaryKey="adxregistrator_exe" Execute="deferred" ExeCommand="/install=&quot;[INSTALLFOLDER]$(var.OF.OutlookPlugin.TargetFileName)&quot; /privileges=user /returnExitCode=false" Impersonate="yes" />
    <CustomAction Id="UnregisterDll" BinaryKey="adxregistrator_exe" Execute="deferred" ExeCommand="/uninstall=&quot;[INSTALLFOLDER]$(var.OF.OutlookPlugin.TargetFileName)&quot; /privileges=user" Impersonate="yes" Return="ignore" />
    <CustomAction Id="Deactivate" BinaryKey="managedAction" DllEntry="Deactivate" Execute="immediate" Return="check" />
    <CustomAction Id="DeleteFiles" BinaryKey="managedAction" DllEntry="ClearFiles" Execute="immediate" Return="check" />
    <CustomAction Id="ResetRegistry" BinaryKey="managedAction" DllEntry="ResetRegistry" Execute="immediate" Return="check" />
    <!--<CustomAction Id="CloseOutlook" BinaryKey="managedAction" DllEntry="CloseOutlook" Execute="immediate" Return="check" />-->
    <!--<CustomAction Id="OpenOutlook" BinaryKey="managedAction" DllEntry="OpenOutlook" Execute="immediate" Return="check" />-->
    <CustomAction Id="SuccesMessage" BinaryKey="managedAction" DllEntry="SuccesMessage" Execute="immediate" Return="check" />
    <CustomAction Id="CancelMessage" BinaryKey="managedAction" DllEntry="CancelMessage" Execute="immediate" Return="check" />
    <CustomAction Id="ErrorMessage" BinaryKey="managedAction" DllEntry="ErrorMessage" Execute="immediate" Return="check" />
    <!--<CustomAction Id="EmailValidation" BinaryKey="managedAction" DllEntry="EmailValidation" Execute="immediate" Return="check" />-->
    <CustomAction Id="ClosePrompt" BinaryKey="managedAction" DllEntry="ClosePrompt" Execute="immediate" Return="check" />
    <?ifndef TRIAL ?>
    <CustomAction Id="ActivatePlugin" BinaryKey="managedAction" DllEntry="ActivatePlugin" Execute="immediate" Return="check" />

    <CustomAction Id="InstallElasticSearch" BinaryKey="managedAction" DllEntry="InstallElasticSearch" Return="check" Execute="immediate" />

    <CustomAction Id="UnInstallElasticSearch" BinaryKey="managedAction" DllEntry="UnInstallElasticSearch" Execute="immediate" Return="check" />
    <CustomAction Id="SetJavaSdkVariable" BinaryKey="managedAction" DllEntry="SetJavaSdkVariable" Execute="immediate" Return="check" />
    
    
    <?endif?>
    <InstallExecuteSequence>
      <RemoveExistingProducts After="InstallValidate" />
      <Custom Action="RegisterDll" After="SelfRegModules">NOT Installed</Custom>
      <Custom Action="ResetRegistry" After="RegisterDll">NOT Installed</Custom>
      <Custom Action="UnregisterDll" After="SelfUnregModules">Installed</Custom>
      <Custom Action="Deactivate" After="UnregisterDll">Installed</Custom>
      <Custom Action="UnInstallElasticSearch" After="Deactivate">Installed</Custom>
      <Custom Action="DeleteFiles" After="InstallFinalize">REMOVE="ALL"</Custom>
      <Custom Action='SetJavaSdkVariable' After='InstallFinalize'>NOT Installed</Custom>
      <Custom Action='InstallElasticSearch' After='SetJavaSdkVariable'>NOT Installed</Custom>
      <Custom Action="ClosePrompt" After="CostFinalize">NOT Installed OR Installed OR REMOVE="ALL"</Custom>
      <!--<Custom Action="CloseOutlook" After="AppSearch">NOT Installed OR Installed OR REMOVE="ALL"</Custom>-->
      <Custom Action="SuccesMessage" OnExit="success">NOT Installed</Custom>
      <Custom Action="CancelMessage" OnExit="cancel">NOT Installed</Custom>
      <Custom Action="ErrorMessage" OnExit="error">NOT Installed</Custom>
      <?ifndef TRIAL ?>
      <!--<Custom Action="ActivatePlugin" After="SelfRegModules">NOT Installed</Custom>-->
      <?endif?>
      <!--<Custom Action="ActivatePlugin" After="InstallInitialize">NOT Installed</Custom>-->
      <!--<Custom Action="OpenOutlook" After="InstallFinalize">NOT Installed OR Installed</Custom>-->
    </InstallExecuteSequence>
    <!-- Properties for all current versions of the .NET Framework are available here: http://wix.sourceforge.net/manual-wix3/wixnetfxextension.htm -->
    <PropertyRef Id="NETFRAMEWORK40CLIENT" />
    <Condition Message="This application requires .NET Framework 4.0. Please install the .NET Framework then run this installer again."><![CDATA[Installed OR NETFRAMEWORK40CLIENT]]></Condition>
    <!-- Check some requirements ONLY on "install", but not on modify or uninstall. -->
    <Property Id="JAVA_CURRENT_VERSION">
      <RegistrySearch Id="JRE_CURRENT_VERSION_REGSEARCH" Root="HKLM" Key="SOFTWARE\JavaSoft\Java Runtime Environment" Name="CurrentVersion" Type="raw" Win64="yes" />
    </Property>
    <Condition Message="Java Runtime Environment (32 Bit) is not installed or outdated. Please install Oracle JRE 1.7 or later."><![CDATA[Installed OR (JAVA_CURRENT_VERSION >= "1.7")]]></Condition>
    
  </Product>
  <Fragment>
    <Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="LocalAppDataFolder">
        <Directory Id="INSTALLFOLDER" Name="OutlookFinder">
          <Component Id="INSTALLFOLDER" Guid="c7b05686-b33f-4d75-ae82-aa8c069e6a7d">
            <RemoveFolder On="both" Id="INSTALLFOLDER" />
            <RegistryValue Root="HKCU" Key="Software\[Manufacturer]\[ProductName]" Type="string" Value="OutlookFinder" />
          </Component>
          <Directory Id="INSTALLFOLDERLIB" Name="lib">
            <Component Id="INSTALLFOLDERLIB" Guid="129FC695-F5F1-4476-A5C4-B12642EE5324">
              <RemoveFolder On="both" Id="INSTALLFOLDERLIB" />
              <RegistryValue Root="HKCU" Key="Software\[Manufacturer]\[ProductName]" Type="string" Value="lib" />
            </Component>
          </Directory>
          <Directory Id="INSTALLFOLDERLIB64" Name="lib64">
            <Component Id="INSTALLFOLDERLIB64" Guid="564C4477-7148-40C6-B90E-3C42DF281BD3">
              <RemoveFolder On="uninstall" Id="INSTALLFOLDERLIB64" />
              <RegistryValue Root="HKCU" Key="Software\[Manufacturer]\[ProductName]" Type="string" Value="lib64" />
            </Component>
          </Directory>
        </Directory>

        <!-- elastic search dir -->
        <Directory Id="ELASTICSEASRCHINSTALLFOLDER" Name="ElasticSearch">

          <Component Id="ELASTICSEASRCHINSTALLFOLDER" Guid="20D2309D-3D31-45C6-9C34-34859D61A91B">
            <RemoveFolder On="both" Id="ELASTICSEASRCHINSTALLFOLDER" />
            <RegistryValue Root="HKCU" Key="Software\ElasticSearch" Type="string" Value="ElasticSearch" />
          </Component>

          <Directory Id="ELASTICSEASRCHINSTALLFOLDERBIN" Name="bin">
            <Component Id="ELASTICSEASRCHINSTALLFOLDERBIN" Guid="7B2ED621-76B5-4FBC-BB23-8E0FADE4BDCC">
              <RemoveFolder On="both" Id="ELASTICSEASRCHINSTALLFOLDERBIN" />
              <RegistryValue Root="HKCU" Key="Software\ElasticSearch" Type="string" Value="bin" />
            </Component>
          </Directory>

          <Directory Id="ELASTICSEASRCHINSTALLFOLDERCONFIG" Name="config">
            <Component Id="ELASTICSEASRCHINSTALLFOLDERCONFIG" Guid="20AEDE7C-8EA0-4B41-B33A-7DDC77DF9925">
              <RemoveFolder On="both" Id="ELASTICSEASRCHINSTALLFOLDERCONFIG" />
              <RegistryValue Root="HKCU" Key="Software\ElasticSearch" Type="string" Value="config" />
            </Component>
          </Directory>
          
          <Directory Id="ELASTICSEASRCHINSTALLFOLDERPLUGINS" Name="plugins">
            <Component Id="ELASTICSEASRCHINSTALLFOLDERPLUGINS" Guid="E8C9D655-A35C-40C5-A576-73E400DEF3CA">
              <RemoveFolder On="both" Id="ELASTICSEASRCHINSTALLFOLDERPLUGINS" />
              <RegistryValue Root="HKCU" Key="Software\ElasticSearch" Type="string" Value="plugins" />
            </Component>
          </Directory>

          <Directory Id="ELASTICSEASRCHINSTALLFOLDERLIB" Name="lib">
            <Component Id="ELASTICSEASRCHINSTALLFOLDERLIB" Guid="7FA11EB8-B03F-44AB-B620-C8263C37C637">
              <RemoveFolder On="both" Id="ELASTICSEASRCHINSTALLFOLDERLIB" />
              <RegistryValue Root="HKCU" Key="Software\ElasticSearch" Type="string" Value="lib" />
            </Component>

            <Directory Id="ELASTICSEASRCHINSTALLFOLDERLIBSIGAR" Name="sigar">
              <Component Id="ELASTICSEASRCHINSTALLFOLDERLIBSIGAR" Guid="CDA8023C-E724-4843-8F03-587D6CF64C53">
                <RemoveFolder On="both" Id="ELASTICSEASRCHINSTALLFOLDERLIBSIGAR" />
                <RegistryValue Root="HKCU" Key="Software\ElasticSearch" Type="string" Value="sigar" />
              </Component>
            </Directory>


          </Directory>

        </Directory>
        
      </Directory>
    </Directory>
  </Fragment>
  
  <Fragment>
    <ComponentGroup Id="ProductComponents">
      <!-- gfl wrappers for x86 and x64 systems -->
      <Component Id="ProductComponentLib" Guid="E3C62440-D5F8-43C3-905B-DDD2BC79D872" DiskId="1" Directory="INSTALLFOLDERLIB">
        <RegistryKey Root="HKCU" Key="Software\[Manufacturer]\[ProductName]">
          <RegistryValue Type="string" Name="Installed" Value="[INSTALLFOLDERLIB]" KeyPath="yes" />
        </RegistryKey>
        <File Id="_GflWrapper_dll_1" Name="GflWrapper.dll" Source="$(var.OF.OutlookPlugin.TargetDir)lib\" />
        <File Id="_libgfl340_dll_1" Name="libgfl340.dll" Source="$(var.OF.OutlookPlugin.TargetDir)lib\" />
        <File Id="_libgfle340_dll_1" Name="libgfle340.dll" Source="$(var.OF.OutlookPlugin.TargetDir)lib\" />
        <File Id="_PDFLibNet_dll_1" Name="PDFLibNet.dll" Source="$(var.OF.OutlookPlugin.TargetDir)lib\" />
      </Component>
      <Component Id="ProductComponentLib64" Guid="4685C8D4-3DE8-49B3-9ED4-13535C9E134D" DiskId="1" Directory="INSTALLFOLDERLIB64">
        <RegistryKey Root="HKCU" Key="Software\[Manufacturer]\[ProductName]">
          <RegistryValue Type="string" Name="Installed" Value="[INSTALLFOLDERLIB64]" KeyPath="yes" />
        </RegistryKey>
        <File Id="_GflWrapper_dll_2" Name="GflWrapper.dll" Source="$(var.OF.OutlookPlugin.TargetDir)lib64\" />
        <File Id="_libgfl340_dll_2" Name="libgfl340.dll" Source="$(var.OF.OutlookPlugin.TargetDir)lib64\" />
        <File Id="_libgfle340_dll_2" Name="libgfle340.dll" Source="$(var.OF.OutlookPlugin.TargetDir)lib64\" />
        <File Id="_PDFLibNet_dll_2" Name="PDFLibNet.dll" Source="$(var.OF.OutlookPlugin.TargetDir)lib\" />
      </Component>
      <!-- main components -->
      <Component Id="ProductComponent" Guid="515bb330-8d0b-4160-b5e2-a41f32a1c0d5" DiskId="1" Directory="INSTALLFOLDER">
        <RegistryKey Root="HKCU" Key="Software\[Manufacturer]\[ProductName]">
          <RegistryValue Type="string" Name="Installed" Value="[INSTALLFOLDER]" KeyPath="yes" />
        </RegistryKey>
        <File Id="_$(var.OF.OutlookPlugin.TargetName)_dll" Name="$(var.OF.OutlookPlugin.TargetFileName)" Source="$(var.OF.OutlookPlugin.TargetPath)" />
        <File Id="_adxloader_dll_manifest" Name="adxloader.dll.manifest" Source="$(var.OF.OutlookPlugin.ProjectDir)Loader\" />
        <File Id="_adxloader_dll" Name="adxloader.dll" Source="$(var.OF.OutlookPlugin.ProjectDir)Loader\" />
        <File Id="_adxloader64_dll" Name="adxloader64.dll" Source="$(var.OF.OutlookPlugin.ProjectDir)Loader\" />
        <File Id="_AddinExpress_MSO_2005_dll" Name="AddinExpress.MSO.2005.dll" Source="C:\Program Files (x86)\Add-in Express\Add-in Express for .NET\Bin\" />
        <File Id="_AddinExpress_OL_2005_dll" Name="AddinExpress.OL.2005.dll" Source="C:\Program Files (x86)\Add-in Express\Add-in Express for .NET\Bin\" />
        <File Id="_Extensibility_dll" Name="Extensibility.dll" Source="C:\Windows\assembly\GAC\Extensibility\7.0.3300.0__b03f5f7f11d50a3a\" />
        <File Id="_Microsoft_Office_Interop_Outlook_dll" Name="Microsoft.Office.Interop.Outlook.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_OFPreview_dll" Name="OFPreview.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_OF_Control_dll" Name="OF.Control.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_ICSharpCode_SharpZipLib_dll" Name="ICSharpCode.SharpZipLib.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_log4net_config" Name="log4net.config" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_log4net_dll" Name="log4net.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_log4net_xml" Name="log4net.xml" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_MahApps_Metro_dll" Name="MahApps.Metro.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_MahApps_Metro_Resources_dll" Name="MahApps.Metro.Resources.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_Microsoft_Ink_dll" Name="Microsoft.Ink.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_Microsoft_Office_Interop_Excel_dll" Name="Microsoft.Office.Interop.Excel.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_Microsoft_Office_Interop_Word_dll" Name="Microsoft.Office.Interop.Word.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_Microsoft_Practices_Prism_dll" Name="Microsoft.Practices.Prism.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_Microsoft_Practices_Prism_UnityExtensions_dll" Name="Microsoft.Practices.Prism.UnityExtensions.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_Microsoft_Practices_Prism_UnityExtensions_xml" Name="Microsoft.Practices.Prism.UnityExtensions.xml" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_Microsoft_Practices_Prism_xml" Name="Microsoft.Practices.Prism.xml" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_Microsoft_Practices_ServiceLocation_dll" Name="Microsoft.Practices.ServiceLocation.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_Microsoft_Practices_ServiceLocation_xml" Name="Microsoft.Practices.ServiceLocation.xml" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_Microsoft_Practices_Unity_dll" Name="Microsoft.Practices.Unity.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_Microsoft_Practices_Unity_xml" Name="Microsoft.Practices.Unity.xml" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_Microsoft_Vbe_Interop_dll" Name="Microsoft.Vbe.Interop.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_Office_dll" Name="Office.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_PDFLibNet_dll" Name="PDFLibNet.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_ICSharpCode_AvalonEdit_dll" Name="ICSharpCode.AvalonEdit.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_System_Windows_Interactivity_dll" Name="System.Windows.Interactivity.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_OFPreview_dll_config" Name="OFPreview.dll.config" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_OF_Infrastructure_dll" Name="OF.Infrastructure.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_OF_Module_dll" Name="OF.Module.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_Html_Agility_Pack_dll" Name="HtmlAgilityPack.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_OF_Core_dll" Name="OF.Core.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_Turbo_Activate_dat" Name="TurboActivate.dat" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_Turbo_Activate_dll" Name="TurboActivate.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_Turbo_Activate_exe" Name="TurboActivate.exe" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_Turbo_Activate64_dll" Name="TurboActivate64.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_unistall_exe" Name="unistall.exe" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_OF_OutlookPlugin_dll_config" Name="OF.OutlookPlugin.dll.config" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_antlr_runtime_dll" Name="antlr.runtime.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_DDay_Collections_dll" Name="DDay.Collections.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_DDay_iCal_dll" Name="DDay.iCal.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_Transitionals_dll" Name="Transitionals.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />

        <File Id="_Elasticsearch_Net_dll" Name="Elasticsearch.Net.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_Nest_dll" Name="Nest.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        <File Id="_Newtonsoft_Json_dll" Name="Newtonsoft.Json.dll" Source="$(var.OF.OutlookPlugin.TargetDir)" />
        
        
        
        
      </Component>
    </ComponentGroup>
  </Fragment>
  <Fragment>
    <ComponentGroup Id="ElasticSearchComponents">
      <!-- elastic search main -->
      <Component Id="ElasticSearchProductComponent" Guid="03D268AC-83A1-45AA-9C92-3D7AB7E102F0" DiskId="1" Directory="ELASTICSEASRCHINSTALLFOLDER">
        <RegistryKey Root="HKCU" Key="Software\ElasticSearch">
          <RegistryValue Type="string" Name="Installed" Value="[ELASTICSEASRCHINSTALLFOLDER]" KeyPath="yes" />
        </RegistryKey>
        <File Id="_LICENSE_txt" Name="LICENSE.txt" Source="$(var.SolutionDir)Toolkits\Elasticsearch\"/>
        <File Id="_NOTICE_txt" Name="NOTICE.txt" Source="$(var.SolutionDir)Toolkits\Elasticsearch\"/>
        <File Id="_README_textile" Name="README.textile" Source="$(var.SolutionDir)Toolkits\Elasticsearch\"/>
      </Component>

      <Component Id="ElasticSearchProductComponentBin" Guid="3CC2D98E-C9F0-4DEE-8C20-62E25B6543D5" DiskId="1" Directory="ELASTICSEASRCHINSTALLFOLDERBIN">
        <RegistryKey Root="HKCU" Key="Software\ElasticSearch">
          <RegistryValue Type="string" Name="Installed" Value="[ELASTICSEASRCHINSTALLFOLDERBIN]" KeyPath="yes" />
        </RegistryKey>
        <File Id="_elasticsearch_" Name="elasticsearch" Source="$(var.SolutionDir)Toolkits\Elasticsearch\bin\"/>
        <File Id="_elasticsearch_bat" Name="elasticsearch.bat" Source="$(var.SolutionDir)Toolkits\Elasticsearch\bin\"/>
        <File Id="_elasticsearch_service_mgr_exe" Name="elasticsearch-service-mgr.exe" Source="$(var.SolutionDir)Toolkits\Elasticsearch\bin\"/>
        <File Id="_elasticsearch_service_x64_exe" Name="elasticsearch-service-x64.exe" Source="$(var.SolutionDir)Toolkits\Elasticsearch\bin\"/>
        <File Id="_elasticsearch_service_x86_exe" Name="elasticsearch-service-x86.exe" Source="$(var.SolutionDir)Toolkits\Elasticsearch\bin\"/>
        <File Id="_elasticsearch_in_sh" Name="elasticsearch.in.sh" Source="$(var.SolutionDir)Toolkits\Elasticsearch\bin\"/>
        <File Id="_plugin_" Name="plugin" Source="$(var.SolutionDir)Toolkits\Elasticsearch\bin\"/>
        <File Id="_plugin_bat" Name="plugin.bat" Source="$(var.SolutionDir)Toolkits\Elasticsearch\bin\"/>
        <File Id="_removeplugin_bat" Name="removeplugin.bat" Source="$(var.SolutionDir)Toolkits\Elasticsearch\bin\"/>
        <File Id="_service_bat" Name="service.bat" Source="$(var.SolutionDir)Toolkits\Elasticsearch\bin\"/>
      </Component>

      <Component Id="ElasticSearchConfigProductComponent" Guid="C7B8FDDD-0F0C-4ABD-83ED-58B15C1262AA" DiskId="1" Directory="ELASTICSEASRCHINSTALLFOLDERCONFIG">
        <RegistryKey Root="HKCU" Key="Software\ElasticSearch">
          <RegistryValue Type="string" Name="Installed" Value="[ELASTICSEASRCHINSTALLFOLDERCONFIG]" KeyPath="yes" />
        </RegistryKey>
        <File Id="_elasticsearch_yml" Name="elasticsearch.yml" Source="$(var.SolutionDir)Toolkits\Elasticsearch\config\"/>
        <File Id="_logging_yml" Name="logging.yml" Source="$(var.SolutionDir)Toolkits\Elasticsearch\config\"/>
      </Component>

      <Component Id="ElasticSearchLibProductComponent" Guid="F3D1954B-7861-41C6-98A4-3D21E2A3CB32" DiskId="1" Directory="ELASTICSEASRCHINSTALLFOLDERLIB">
        <RegistryKey Root="HKCU" Key="Software\ElasticSearch">
          <RegistryValue Type="string" Name="Installed" Value="[ELASTICSEASRCHINSTALLFOLDERLIB]" KeyPath="yes" />
        </RegistryKey>
        <File Id="_antlr_runtime_3_5_jar" Name="antlr-runtime-3.5.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
        <File Id="_asm_4_1_jar" Name="asm-4.1.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
        <File Id="_asm_commons_4_1_jar" Name="asm-commons-4.1.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
        <File Id="_elasticsearch_1_3_6_jar" Name="elasticsearch-1.3.6.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
        <File Id="_groovy_all_2_3_2_jar" Name="groovy-all-2.3.2.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
        <File Id="_jna_4_1_0_jar" Name="jna-4.1.0.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
        <File Id="_jts_1_13_jar" Name="jts-1.13.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
        <File Id="_log4j_1_2_17_jar" Name="log4j-1.2.17.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
        <File Id="_lucene_analyzers_common_4_9_1_jar" Name="lucene-analyzers-common-4.9.1.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
        <File Id="_lucene_codecs_4_9_1_jar" Name="lucene-codecs-4.9.1.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
        <File Id="_lucene_core_4_9_1_jar" Name="lucene-core-4.9.1.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
        <File Id="_lucene_expressions_4_9_1_jar" Name="lucene-expressions-4.9.1.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
        <File Id="_lucene_grouping_4_9_1_jar" Name="lucene-grouping-4.9.1.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
        <File Id="_lucene_highlighter_4_9_1_jar" Name="lucene-highlighter-4.9.1.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
        <File Id="_lucene_join_4_9_1_jar" Name="lucene-join-4.9.1.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
        <File Id="_lucene_memory_4_9_1_jar" Name="lucene-memory-4.9.1.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
        <File Id="_lucene_misc_4_9_1_jar" Name="lucene-misc-4.9.1.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
        <File Id="_lucene_queries_4_9_1_jar" Name="lucene-queries-4.9.1.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
        <File Id="_lucene_queryparser_4_9_1_jar" Name="lucene-queryparser-4.9.1.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
        <File Id="_lucene_sandbox_4_9_1_jar" Name="lucene-sandbox-4.9.1.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
        <File Id="_lucene_spatial_4_9_1_jar" Name="lucene-spatial-4.9.1.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
        <File Id="_lucene_suggest_4_9_1_jar" Name="lucene-suggest-4.9.1.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
        <File Id="_spatial4j_0_4_1_jar" Name="spatial4j-0.4.1.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\"/>
      </Component>


      <Component Id="ElasticSearchLibSigarProductComponent" Guid="7BACBEF6-7A63-46F3-8D1E-85486A5D870A" DiskId="1" Directory="ELASTICSEASRCHINSTALLFOLDERLIBSIGAR">
        <RegistryKey Root="HKCU" Key="Software\ElasticSearch">
          <RegistryValue Type="string" Name="Installed" Value="[ELASTICSEASRCHINSTALLFOLDERLIBSIGAR]" KeyPath="yes" />
        </RegistryKey>
        <File Id="_libsigar_amd64_freebsd_6_so" Name="libsigar-amd64-freebsd-6.so" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\sigar\"/>
        <File Id="_libsigar_amd64_linux_so" Name="libsigar-amd64-linux.so" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\sigar\"/>
        <File Id="_libsigar_amd64_solaris_so" Name="libsigar-amd64-solaris.so" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\sigar\"/>
        <File Id="_libsigar_ia64_linux_so" Name="libsigar-ia64-linux.so" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\sigar\"/>
        <File Id="_libsigar_sparc_solaris_so" Name="libsigar-sparc-solaris.so" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\sigar\"/>
        <File Id="_libsigar_sparc64_solaris_so" Name="libsigar-sparc64-solaris.so" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\sigar\"/>
        <File Id="_libsigar_universal_macosx_dylib" Name="libsigar-universal-macosx.dylib" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\sigar\"/>
        <File Id="_libsigar_universal64_macosx_dylib" Name="libsigar-universal64-macosx.dylib" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\sigar\"/>
        <File Id="_libsigar_x86_freebsd_5_so" Name="libsigar-x86-freebsd-5.so" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\sigar\"/>
        <File Id="_libsigar_x86_freebsd_6_so" Name="libsigar-x86-freebsd-6.so" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\sigar\"/>
        <File Id="_libsigar_x86_linux_so" Name="libsigar-x86-linux.so" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\sigar\"/>
        <File Id="_libsigar_x86_solaris_so" Name="libsigar-x86-solaris.so" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\sigar\"/>
        <File Id="_sigar_1_6_4_jar" Name="sigar-1.6.4.jar" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\sigar\"/>
        <File Id="_sigar_amd64_winnt_dll" Name="sigar-amd64-winnt.dll" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\sigar\"/>
        <File Id="_sigar_x86_winnt_dll" Name="sigar-x86-winnt.dll" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\sigar\"/>
        <File Id="_sigar_x86_winnt_lib" Name="sigar-x86-winnt.lib" Source="$(var.SolutionDir)Toolkits\Elasticsearch\lib\sigar\"/>
      </Component>
      
      
    </ComponentGroup>
  </Fragment>
</Wix>