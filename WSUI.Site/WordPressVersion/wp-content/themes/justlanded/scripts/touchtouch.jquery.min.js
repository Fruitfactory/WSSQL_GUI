(function(e,t,n){"use strict";var r=e('<div id="galleryOverlay">'),i=e('<div id="gallerySlider">'),s=e('<div id="imageTitle">'),o=e('<a id="prevArrow"></a>'),u=e('<a id="nextArrow"></a>'),a=false;e.fn.touchTouch=function(){function h(){e(t).bind("keydown.touchTouch",function(e){if(e.keyCode==27){e.preventDefault();d()}if(e.keyCode==37){w()}else if(e.keyCode==39){b()}})}function p(e){if(a){return false}r.show();setTimeout(function(){r.addClass("visible")},100);v(e);a=true}function d(){if(!a){return false}r.hide().removeClass("visible");a=false;e(".placeholder").empty();c=l}function v(t){i.css("left",-t*100+"%");var n=e(c.eq(t)).data();if(c.eq(t).attr("title")){s.html(c.eq(t).attr("title"));s.fadeIn()}else{s.html("");s.fadeOut()}}function m(e){setTimeout(function(){g(e)},1e3)}function g(e){if(e<0||e>=c.length){return false}y(c.eq(e).attr("href"),function(){n.eq(e).html(this)})}function y(t,n){var r=e("<img>").on("load",function(){n.call(r)});r.attr("src",t)}function b(){if(f+1<c.length){f++;v(f);m(f+1)}else{i.addClass("rightSpring");setTimeout(function(){i.removeClass("rightSpring")},500)}}function w(){if(f>0){f--;v(f);m(f-1)}else{i.addClass("leftSpring");setTimeout(function(){i.removeClass("leftSpring")},500)}}var n=e([]),f=0,l=this,c=l;r.hide().appendTo("body");i.appendTo(r);s.appendTo(r);c.each(function(){n=n.add(e('<div class="placeholder">'))});i.append(n).on("click",function(t){if(!e(t.target).is("img")){d()}});e("body").on("touchstart","#gallerySlider img",function(e){var t=e.originalEvent,n=t.changedTouches[0].pageX;i.on("touchmove",function(e){e.preventDefault();t=e.originalEvent.touches[0]||e.originalEvent.changedTouches[0];if(t.pageX-n>10){i.off("touchmove");w()}else if(t.pageX-n<-10){i.off("touchmove");b()}});return false}).on("touchend",function(){i.off("touchmove")});c.on("click",function(t){t.preventDefault();var n=e(this),r,i,s=n.parent().closest("[data-gallery]");if(n.attr("data-gallery")){r=n.attr("data-gallery");i="item"}else if(s.length){r=s.attr("data-gallery");i="ancestor"}if(r&&i=="item"){c=e("[data-gallery="+r+"]")}else if(r&&i=="ancestor"){c=c.filter(function(){return e(this).parent().closest("[data-gallery]").length})}f=c.index(this);p(f);g(f);m(f+1);m(f-1)});if(!("ontouchstart"in t)){r.append(o).append(u);o.click(function(e){e.preventDefault();w()});u.click(function(e){e.preventDefault();b()})}h()}})(jQuery,this)