///////////////////////////////////////////////////////////
//  EmailSubjectSearchRule.cs
//  Implementation of the Class EmailSubjectSearchRule
//  Generated by Enterprise Architect
//  Created on:      29-Sep-2013 10:41:48 AM
//  Original author: Yariki
///////////////////////////////////////////////////////////


using System;
using System.Collections.Generic;
using System.Linq;
using System.Linq.Expressions;
using WSUI.Core.Core.AdvancedSearchCriteria;
using WSUI.Core.Core.Rules;
using WSUI.Core.Data.ElasticSearch;
using WSUI.Core.Enums;
using WSUI.Core.Extensions;
using WSUI.Infrastructure.Implements.Rules.BaseRules;

namespace WSUI.Infrastructure.Implements.Rules
{
    public class EmailSubjectSearchRule : BaseEmailSearchRule
    {

        private string AscTemplateFirst = "  ORDER BY System.Message.DateReceived ASC";
        private string AscTemplateContinue = " AND System.Message.DateReceived > '{0}' ORDER BY System.Message.DateReceived ASC";

        private string DescTemplate = " AND System.Message.DateReceived < '{0}' ORDER BY System.Message.DateReceived DESC";

        private string WhereTemplate =
            "WHERE CONTAINS(System.Kind,'email') AND System.Message.DateReceived < '{0}' AND CONTAINS(System.Subject,{1},1033) ORDER BY System.Message.DateReceived DESC";

        private string WhereAdvancedTemplate = "WHERE CONTAINS(System.Kind,'email')  AND {0} {1}";

        public EmailSubjectSearchRule()
        {
            Priority = 2;
        }

        public EmailSubjectSearchRule(object lockObject)
            : base(lockObject)
        {
            Priority = 2;
        }

        protected override bool GetIncludedInAdvancedMode()
        {
            return true;
        }

        public override void Init()
        {
            RuleName = "EmailSubject";
            base.Init();
        }

        protected override Expression<Func<WSUIEmail, string>> GetSearchedProperty()
        {
            return e => e.Subject;
        }
    }//end EmailSubjectSearchRule

}//end namespace Implements